name: Desplegar en CentOS via SSH (con contraseÃ±a)

on:
  push:
    branches:
      - master   # Cambia si usas otra rama
  workflow_dispatch:
jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸš€ Desplegar en CentOS Stream 9
        uses: appleboy/ssh-action@v1.2.2
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USERNAME }}
          password: ${{ secrets.SSH_PASSWORD }}
          port: ${{ secrets.SSH_PORT }}
          script: |
            echo "ðŸ“¦ Actualizando proyecto..."
            cd ${{ secrets.MARCELL_PATH }}

            # Pull desde GitHub
            git pull origin master

            # Instalar dependencias
            npm install

            # Construir proyecto (si es necesario)
            npm run build

            echo "ðŸ”„ Reiniciando aplicaciÃ³n..."
            pm2 restart tesis || echo "PM2 no estÃ¡ corriendo o no se encontrÃ³ el proceso"

            echo "âœ… Despliegue completado"